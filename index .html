<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SCHOLAR LINK</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

<style>
body{font-family:Poppins;margin:0;background:#f4f6fb}
header{background:#0d47a1;color:white;text-align:center;padding:20px}
nav{text-align:center;background:#1565c0;padding:10px}
nav button{margin:5px;padding:8px 15px;border:none;border-radius:5px;background:#ff6f00;color:white;cursor:pointer}
section{max-width:1000px;margin:auto;padding:30px}
input{padding:8px;margin:5px;border-radius:5px;border:1px solid #ccc}
.book{background:white;padding:15px;margin:10px 0;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,0.1)}
.btn{background:#ff6f00;color:white;padding:8px 15px;border-radius:5px;text-decoration:none;cursor:pointer}
.hidden{display:none}
</style>
</head>

<body>

<header>
<h1>SCHOLAR LINK</h1>
<p>Free Books | SHS • TVET • University</p>
</header>

<nav>
<button onclick="register()">Register</button>
<button onclick="login()">Login</button>
<button onclick="logout()">Logout</button>
</nav>

<section id="adminPanel" class="hidden">
<h2>Admin Upload (Only You)</h2>
<input id="title" placeholder="Book Title">
<input id="category" placeholder="Category">
<input id="link" placeholder="PDF Link">
<button class="btn" onclick="addBook()">Upload Book</button>
</section>

<section>
<h2>Search Books</h2>
<input type="text" id="search" placeholder="Search..." onkeyup="searchBooks()">
<div id="books"></div>
</section>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAyy5jBF7vKQBf7fL9wcjoX20_xEhnEMjw",
  authDomain: "scholar-link-3125b.firebaseapp.com",
  projectId: "scholar-link-3125b",
  storageBucket: "scholar-link-3125b.firebasestorage.app",
  messagingSenderId: "540927344053",
  appId: "1:540927344053:web:dc555f4e462cf5e38eedfc",
  measurementId: "G-CHV3DNSYEG"
};

const app = initializeApp(firebaseConfig);
getAnalytics(app);

const auth = getAuth();
const db = getFirestore();

window.register = function(){
let email=prompt("Email:");
let pass=prompt("Password:");
createUserWithEmailAndPassword(auth,email,pass)
.catch(e=>alert(e.message));
}

window.login = function(){
let email=prompt("Email:");
let pass=prompt("Password:");
signInWithEmailAndPassword(auth,email,pass)
.catch(e=>alert(e.message));
}

window.logout = function(){
signOut(auth);
}

onAuthStateChanged(auth,(user)=>{
if(user && user.email==="oosei812@gmail.com"){
document.getElementById("adminPanel").classList.remove("hidden");
}else{
document.getElementById("adminPanel").classList.add("hidden");
}
});

window.addBook = async function(){
let title=document.getElementById("title").value;
let category=document.getElementById("category").value;
let link=document.getElementById("link").value;
await addDoc(collection(db,"books"),{title,category,link});
alert("Book Added");
}

onSnapshot(collection(db,"books"),(snapshot)=>{
let booksDiv=document.getElementById("books");
booksDiv.innerHTML="";
snapshot.forEach(doc=>{
let book=doc.data();
booksDiv.innerHTML+=`
<div class="book">
<h3>${book.title}</h3>
<p>${book.category}</p>
<a class="btn" href="${book.link}" target="_blank">Download</a>
</div>
`;
});
});

window.searchBooks=function(){
let input=document.getElementById("search").value.toLowerCase();
let books=document.getElementsByClassName("book");
for(let i=0;i<books.length;i++){
let title=books[i].innerText.toLowerCase();
books[i].style.display=title.includes(input)?"":"none";
}
}

</script>

</body>
</html>